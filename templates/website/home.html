{% extends 'website/base.html' %}
{% load static %}

{% block title %}Home - Equacare LLC | Professional Home Care Services{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/home-contact.css' %}">
{% endblock %}

{% block content %}
<!-- Hero Section -->
{% if hero %}
<section class="hero" style="background-image: url('{{ hero.hero_image.url }}');">
    <div class="hero-overlay"></div>
</section>

<!-- Hero Content Section (Below Photo) -->
<section class="hero-content-section">
    <div class="container">
        <div class="hero-content-wrapper">
            <h1>{{ hero.title }}</h1>
            <p>{{ hero.subtitle }}</p>
            <div class="hero-buttons">
                <a href="{{ hero.button_link_1 }}" class="btn btn-primary btn-lg"><i class="fas fa-phone"></i> {{ hero.button_text_1 }}</a>
                <a href="{{ hero.button_link_2 }}" class="btn btn-secondary btn-lg">{{ hero.button_text_2 }}</a>
            </div>
        </div>
    </div>
</section>
{% else %}
<!-- Fallback Hero Section -->
<section class="hero" style="background-image: url('{% static 'images/hero-bg.webp' %}');">
    <div class="hero-overlay"></div>
</section>

<section class="hero-content-section">
    <div class="container">
        <div class="hero-content-wrapper">
            <h1>Caring Support When You Need It Most</h1>
            <p>We know life can be challenging, and we're here to make it easier. Our compassionate caregivers deliver dependable, professional assistance with daily activities to help you live comfortably, safely, and independently at home.</p>
            <div class="hero-buttons">
                <a href="tel:+15155081556" class="btn btn-primary btn-lg"><i class="fas fa-phone"></i> Call Now: (515) 508-1556</a>
                <a href="{% url 'website:contact' %}" class="btn btn-secondary btn-lg">Request Free Consultation</a>
            </div>
        </div>
    </div>
</section>
{% endif %}

<!-- About Preview Section -->
{% if about_preview %}
<section class="about-preview">
    <div class="container">
        <div class="about-preview-grid">
            <div class="about-preview-image">
                <img src="{{ about_preview.preview_image.url }}" alt="{{ about_preview.title }}">
            </div>
            <div class="about-preview-content">
                <span class="section-label">{{ about_preview.section_label }}</span>
                <h2>{{ about_preview.title }}</h2>
                <p>{{ about_preview.content_paragraph_1 }}</p>
                <p>{{ about_preview.content_paragraph_2 }}</p>
                <ul class="check-list">
                    <li><i class="fas fa-check-circle"></i> Personalized care plans</li>
                    <li><i class="fas fa-check-circle"></i> Background-checked caregivers</li>
                    <li><i class="fas fa-check-circle"></i> Flexible scheduling options</li>
                    <li><i class="fas fa-check-circle"></i> Ongoing supervision and support</li>
                </ul>
                <a href="{{ about_preview.button_link }}" class="btn btn-primary">{{ about_preview.button_text }}</a>
            </div>
        </div>
    </div>
</section>
{% else %}
<!-- Fallback About Preview Section -->
<section class="about-preview">
    <div class="container">
        <div class="about-preview-grid">
            <div class="about-preview-image">
                <img src="{% static 'images/about-preview.webp' %}" alt="Caregiver with senior">
            </div>
            <div class="about-preview-content">
                <span class="section-label">About Equacare</span>
                <h2>Flexible Care That Fits Your Life</h2>
                <p>Every family's needs are unique. Whether you're looking for a few hours of assistance each week or comprehensive daily support, we're here to help. From short-term care to ongoing companionship, our team is ready to support you and your loved ones.</p>
                <p>We match you with caregivers who understand your specific needs and connect with your family's personality. Our goal is simple: to make home care a positive, comfortable experience for everyone. Let's talk about how we can help.</p>
                <ul class="check-list">
                    <li><i class="fas fa-check-circle"></i> Personalized care plans</li>
                    <li><i class="fas fa-check-circle"></i> Background-checked caregivers</li>
                    <li><i class="fas fa-check-circle"></i> Flexible scheduling options</li>
                    <li><i class="fas fa-check-circle"></i> Ongoing supervision and support</li>
                </ul>
                <a href="{% url 'website:about' %}" class="btn btn-primary">Learn More About Us</a>
            </div>
        </div>
    </div>
</section>
{% endif %}

<!-- Services Section -->
<section class="services">
    <div class="container">
        {% if services_header %}
        <div class="section-header">
            <span class="section-label">{{ services_header.section_label }}</span>
            <h2>{{ services_header.title }}</h2>
            <p>{{ services_header.subtitle }}</p>
        </div>
        {% else %}
        <div class="section-header">
            <span class="section-label">Our Services</span>
            <h2>How We Can Help</h2>
            <p>From a few hours a week to around-the-clock care, we're here with a helping hand</p>
        </div>
        {% endif %}
        <div class="services-grid">
            {% if services %}
                {% for service in services %}
                <div class="service-card">
                    <div class="service-icon">
                        <i class="{{ service.icon }}"></i>
                    </div>
                    <h3>{{ service.title }}</h3>
                    <p>{{ service.description }}</p>
                </div>
                {% endfor %}
            {% else %}
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-home"></i>
                    </div>
                    <h3>Homemaking</h3>
                    <p>Meal preparation, cleaning, laundry</p>
                </div>
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-hands-helping"></i>
                    </div>
                    <h3>Aide Services</h3>
                    <p>Medication reminders, health monitoring, bathing assistance</p>
                </div>
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-user-friends"></i>
                    </div>
                    <h3>Companionship</h3>
                    <p>Running errands, playing games, hobbies, and more</p>
                </div>
            {% endif %}
        </div>
        <div class="text-center" style="margin-top: 3rem;">
            {% if services_header %}
                <a href="{{ services_header.button_link }}" class="btn btn-primary">{{ services_header.button_text }}</a>
            {% else %}
                <a href="{% url 'website:services' %}" class="btn btn-primary">View All Services</a>
            {% endif %}
        </div>
    </div>
</section>

<!-- Contact Form Section -->
<section class="contact-form-home">
    <div class="container">
        {% if contact_form_section %}
        <div class="contact-form-header">
            <h2>{{ contact_form_section.title }}</h2>
            <p>{{ contact_form_section.subtitle }}</p>
        </div>
        {% else %}
        <div class="contact-form-header">
            <h2>Let Us Know What's On Your Mind</h2>
            <p>Request a no-obligation, in-home consultation</p>
        </div>
        {% endif %}
        <div class="home-contact-wrapper">
            <form id="homeContactForm" class="simple-contact-form">
                {% csrf_token %}
                <div class="form-row">
                    <div class="form-group">
                        <label for="home_name">Name:</label>
                        <input type="text" id="home_name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="home_email">Email:</label>
                        <input type="email" id="home_email" name="email" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="home_phone">Phone:</label>
                        <input type="tel" id="home_phone" name="phone">
                    </div>
                    <div class="form-group">
                        <label for="home_subject">Subject:</label>
                        <select id="home_subject" name="subject" required>
                            <option value="">Select a subject</option>
                            <option value="Free Consultation">Request Free Consultation</option>
                            <option value="General Inquiry">General Inquiry</option>
                            <option value="Services Information">Services Information</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="home_message">Message:</label>
                    <textarea id="home_message" name="message" rows="4" required></textarea>
                </div>
                <button type="submit" class="btn btn-primary btn-block">
                    <span class="btn-text">Send Message</span>
                    <span class="btn-loading" style="display: none;">
                        <i class="fas fa-spinner fa-spin"></i> Sending...
                    </span>
                </button>
                <div id="homeFormMessage" class="form-message"></div>
            </form>
        </div>
    </div>
</section>

<!-- CTA Section -->
{% if cta_section %}
<section class="cta">
    <div class="container">
        <div class="cta-content">
            <h2>{{ cta_section.title }}</h2>
            <p>{{ cta_section.subtitle }}</p>
            {% if cta_section.show_button %}
            <div class="cta-buttons">
                <a href="{{ cta_section.button_link }}" class="btn btn-primary btn-lg"><i class="fas fa-phone"></i> {{ cta_section.button_text }}</a>
            </div>
            {% endif %}
        </div>
    </div>
</section>
{% else %}
<section class="cta">
    <div class="container">
        <div class="cta-content">
            <h2>Ready to Talk?</h2>
            <p>It all starts with a conversation. Call us or send a message above.</p>
            <div class="cta-buttons">
                <a href="tel:+15155081556" class="btn btn-primary btn-lg"><i class="fas fa-phone"></i> Call Now: (515) 508-1556</a>
            </div>
        </div>
    </div>
</section>
{% endif %}
{% endblock %}

{% block extra_js %}
<script>
// Home page contact form handler
document.addEventListener('DOMContentLoaded', function() {
    const homeContactForm = document.getElementById('homeContactForm');
    
    if (homeContactForm) {
        homeContactForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitBtn = homeContactForm.querySelector('button[type="submit"]');
            const btnText = submitBtn.querySelector('.btn-text');
            const btnLoading = submitBtn.querySelector('.btn-loading');
            const formMessage = document.getElementById('homeFormMessage');
            
            // Show loading state
            submitBtn.disabled = true;
            btnText.style.display = 'none';
            btnLoading.style.display = 'inline-block';
            formMessage.textContent = '';
            formMessage.className = 'form-message';
            
            // Get form data
            const formData = new FormData(homeContactForm);
            const data = {
                name: formData.get('name'),
                email: formData.get('email'),
                phone: formData.get('phone'),
                subject: formData.get('subject'),
                message: formData.get('message'),
                csrfmiddlewaretoken: formData.get('csrfmiddlewaretoken')
            };
            
            try {
                const response = await fetch('{% url "website:submit_contact" %}', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': data.csrfmiddlewaretoken
                    },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    formMessage.textContent = result.message;
                    formMessage.className = 'form-message success';
                    homeContactForm.reset();
                } else {
                    formMessage.textContent = result.message;
                    formMessage.className = 'form-message error';
                }
            } catch (error) {
                formMessage.textContent = 'An error occurred. Please try again or call us directly.';
                formMessage.className = 'form-message error';
            } finally {
                // Reset button state
                submitBtn.disabled = false;
                btnText.style.display = 'inline-block';
                btnLoading.style.display = 'none';
            }
        });
    }
});
</script>
{% endblock %}

